\section{سوال اول - نظری}

همانگونه که در کلاس درس آشنا شده‌اید، واحد پردازشی پرسپترون و آدالاین امکان دریافت ورودی، توان‌های متعدد آن و حاصل ضرب ورودی ها را داشته و می‌تواند مسئله دسته‌بندی خطی را حل نمایند. در این سوال، قصد بدست آوردن وزن‌های یک نرون پردازشی پرسپترونی را به صورت نطری و با محاسبات دستی داریم.




\begin{center}
	\includegraphics*[width=1\linewidth]{pics/img1.png}
	\captionof{figure}{مسئله مورد بحث}
	\label{مسئله مورد بحث در سوال۱}
\end{center}



\begin{enumerate}
	\item شکل \lr{a-1} را برای دسته بندی مسئله دودویی درنظر بگیرید. معماری نورون مورد نظر را توضیح داده و وزن‌های آن را بدست آورید.
	
	\begin{qsolve}
		به دلیل آنکه داده های این قسمت جداپذر خطی هستند، می‌توان برای طبقه بندی آنها، از شبکه پرسپترون تک لایه استفاده کرد.
		
		معماری این شبکه به صورت «شکل \ref{معماری شبکه پرسپترون تک لایه}» است.
		
		
		\begin{center}
			\includegraphics*[width=0.8\linewidth]{pics/img2.pdf}
			\captionof{figure}{معماری شبکه پرسپترون تک لایه}
			\label{معماری شبکه پرسپترون تک لایه}
		\end{center}
	\end{qsolve}
	
	\begin{qsolve}
				در این شبکه، ورودی/خروجی ها با مربع های نارنجی، نورون ها با دایره سبز و تابع فعال ساز با مربع آبی نشان داده شده است. تعداد دیتا ورودی شبکه ۲ است. $x_1$ و $x_2$. بایاس این شبکه با $x_0$ نشان داده شده است. وزن های شبکه نیز با $w$ نشان داده شده است. بنابر این بردار ورودی و وزن‌های شبکه به صورت زیر است:
		
		$$
			X=\begin{bmatrix}          
				x_0=1\\
				x_1\\
				x_2
				
				\end{bmatrix} \\\       W=\begin{bmatrix}          
												w_0\\
												w_1\\
												w_2
											
											\end{bmatrix}
		$$
		
		طبق تئوری شبکه‌های عصبی می‌دانیم خروجی نرون به صورت زیر محاسبه می‌شود: (در اینجا برای انجام محاسبات ساده، تابع فعال‌ساز درنظر گرفته نشده است)
		
		$$
			\hat{y}=W^T X = \sum_{i=0}^{2} {w_ix_i}=w_0x_0+w_1x_1+w_2x_2 \xrightarrow{x_0=1} w_0+w_1x_1+w_2x_2
		$$
		
		طبق شکل \lr{a-1} دو نقطه از خط جدا کننده دو کلاس را داریم. بنابراین می‌توان معادله خط را به صورت زیر نوشت.
		
		می‌دانیم معادله خط به صورت زیر تعریف می‌شود:
		$$
			y-y_0=m(x-x_0)
		$$
		
		که در آن $m$ شیب خط است و به صورت زیر $\frac{\Delta y}{\Delta x}$ تعریف می‌شود. با جاگذاری یک از نقاط در معادله خط، می‌توان معادله خط را بدست آورد.
		
		$$
			P_1=\begin{bmatrix}          
				2.5\\
				0
				
			\end{bmatrix} \\\       P_2=\begin{bmatrix}          
				0\\
				2.8
				
			\end{bmatrix}
		$$
		
		$$
			m=\frac{2.8-0}{0-2.5}=-1.12 \rightarrow y-0=-1.12(x-2.5) \rightarrow \boxed{y=-1.12x+2.8}
		$$
		
		حالا اگر معادله خروجی نورون را به صورت زیر مرتب کنیم، می‌توان از مقایسه با مقادله خط بدست آمده وزن‌های شبکه را تعیین کرد.
		
		\begin{eqnarray*}
			x_1=\frac{-w_2}{w_1}x_2-\frac{w_0}{w_1},
			&x_2=\frac{-w_1}{w_2}x_1-\frac{w_0}{w_2}&
		\end{eqnarray*}

		
		در اینجا به دلیل آنکه دو معادله و ۳ مجهول ($w_0,w_1,w_2$) داریم، نیاز است که یکی از وزن ها را فرض کرده و دو وزن دیگر را بدست آورد.
		
		\begin{eqnarray*}
			\frac{-w_2}{w_1}=-1.12 \rightarrow w_2=1.12w_1\\
			\frac{-w_0}{w_1}=2.8 \rightarrow w_0=-2.8w_1\\
			\rightarrow
			\begin{cases}
				w_2-1.12w_1=0\\
				-2.8w_1-w_0=0 
			\end{cases}
			\text{assume} &w_0&=2.8 \rightarrow \text{\hl{$w_1=-1$}}, \text{\hl{$w_2=-1.12$}}
		\end{eqnarray*}
		ذکر این نکته الزامیست که این جواب، یکتا نمی‌باشد و برحسب اینکه مقدار $w_0$ را چه انتخاب کنیم، مقدار ۲ وزن دیگر متفاوت می‌شود.
	\end{qsolve}
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	\item حال شکل \lr{b-1} را درنظر بگیرید. چرا مسئله جداپذیر خطی نیست؟ چگونه می‌توان آن را در قالب حل چند مسئله خطی حل نمود؟ معماری پیشنهادی خودتان را رسم و وزن‌های موجود در آن را با انجام محاسبات بدست آورید. معماری شما می‌تواند حاصل از کنار هم چیدن و پشت هم چیدن یک یا چند نورون پرسپترونی باشد.
\end{enumerate}


\begin{qsolve}
	به مسائلی جداپذیر خطی گفته می‌شود که بتوان داده‌ها (کلاس‌ها) را با استفاده از فقط یک خط از هم جدا کرد. در این مثال، دو کلاس آبی و سبز را نمی‌توان فقط با یک خط از هم جدا کرد. بنابراین این مسئله \textbf{جداپذیر خطی نمی‌باشد.} برای حل این مسئله، چندین روش وجود دارد که در ادامه آنها را توضیح خواهم داد.
	
	\begin{enumerate}
		\item \textbf{افزایش بعد مسئله: }\\
		یعنی در این مثال که مسئله مورد بحث ما دو بعدی است، یک بعد به آن اضاف کنیم و آن را به عنوان یک مسئله ۳ بعدی حل کنیم و تلاش کنیم که یک صفحه برای جدا کردن دو کلاس پیدا کنیم.
		
		\item \textbf{دادن ورودی هایی با توان بالا به عنوان ورودی شبکه: }\\
		در صورتی می‌توان از این روش استفاده کرد که مقدار دقیق تمام نمونه ها را داشته باشیم. در این صورت می‌توان ورودی ها را به توان های بالا (۲ و ۳ و...) رساند و امیدوار باشیم فضای قرارگیری ویژگی های جدید در صفحه به صورت جداپذیر خطی باشد. «این کار در سوال دوم همین سری تمرین انجام شده است و با به توان ۲ رساندن ویژگی های ورودی شبکه، مسئله ای که جداپذیر خطی نبود به جداپذیر خطی تبدیل می‌شود.» در این مسئله به دلیل نداشتن موقعیت دقیق نمونه های هرکلاس نمی‌توان از این روش استفاده کرد.
		
		\item \textbf{اضاف کردن لایه مخفی: }\\
		در اضاف کردن تعداد لایه های مخفی شبکه، آزاد هستیم اما باید به این نکته توجه داشت که اگر بیشتر از یک لایه مخفی به شبکه اضاف کنیم، حل مسئله از نظر خطی بودن خارج شده و نواحی تصمیم گیری شامل خط راست نمی‌شود و نواحی پیچیده تری مانند منحنی ها را در بر می‌گیرد. اما اگر فقط یک لایه مخفی ۳ نورونی به شبکه اضاف کنیم، می‌توان مسئله ای که ذاتا جدا‌پذیر خطی نیست را به وسیله ۳ خط جدا کننده که تعداد این خط ها برابر است با تعداد نورون های لایه مخفی، حل نمود. ساختار این مدل در «شکل \ref{معماری شبکه ۳ لایه پیشنهادی}» آورده شده است.
		
		اما مشکلی که وجود دارد آن است که در صورت سوال از ما خواسته شده وزن های شبکه را بدست آوریم، اگر از این ساختار برای حل استفاده کنیم، به دلیل نداشتن مقدار ورودی ها نمی‌توان ۳ وزن لایه متصل به خروجی را بدست آورد.
		
		\item \textbf{شکستن مسئله به ۳ زیرمسئله خطی}: \\
		برای حل این سوال از این روش استفاده شده است. در قسمت قبل دیدیم که یک نورون پرسپترونی می‌تواند یک خد جدا کننده در صفحه رسم کنید. در این مثال، برای جدا کردن این دو کلاس به ۳ خط نیاز داریم. پس داده‌های ورودی مسئله را به ۳ بخش جدا‌پذیر خطی تقسیم می‌کنیم. «شکل \ref{داده های شکسته شده به سه بخش}» اکنون می‌توان همانند قسمت قبل، وزن ها را برای هر سه زیر‌مسئله بدست آورد.
	\end{enumerate}
\end{qsolve}






\begin{qsolve}
	\begin{center}
		\includegraphics*[width=0.5\linewidth]{pics/img3.pdf}
		\captionof{figure}{معماری شبکه ۳ لایه پیشنهادی}
		\label{معماری شبکه ۳ لایه پیشنهادی}
	\end{center}
	
	\begin{center}
		\includegraphics*[width=1\linewidth]{pics/img4.pdf}
		\captionof{figure}{داده های شکسته شده به سه بخش}
		\label{داده های شکسته شده به سه بخش}
	\end{center}
\end{qsolve}


زیر مسئله شماره ۱ در قسمت قبل حل شده است و وزن های آن به صورت زیر بدست آورده شد:
\begin{eqnarray*}
	w_0=2.8, &w_1=-1, &w_2=-1.12
\end{eqnarray*}

برای دو زیر مسئله دیگر هم، همانند قسمت قبل وزن‌ها را بدست می‌اوریم.

\begin{eqnarray*}
	P_1=\begin{bmatrix}
		2.5\\
		0
	\end{bmatrix}
	P_2&=&\begin{bmatrix}
		-1.5\\
		1.7
	\end{bmatrix}
	\rightarrow m=\frac{\Delta y}{\Delta x}=\frac{y_2-y_1}{x_2-x_1}=\frac{-1.5-2.5}{-1.7-0}=\frac{-4}{-1.7}=\boxed{2.35}\\
	y-0&=&2.35(x-2.5)\rightarrow \boxed{y=2.35x-5.88}\\
	\rightarrow x_1&=&\frac{-w_2}{w_1}x_2-\frac{w_0}{w_1}
\end{eqnarray*}






%
%
%
%
%
%
%
%\begin{qsolve}[]
%	\begin{eqnarray*}
%		p(t)&=&\sum_{n=-\infty}^{\infty}\delta(t-nT)\qquad \text{\lr{periodic in T}}\\
%		a_k &=&\frac{1}{T}\int_{-T/2}^{T/2}f(t)e^{jk(2\pi/T)t}dt=
%		\frac{1}{T}\int_{-T/2}^{T/2}\sum_{n=-\infty}^{\infty}\delta(t-nT)e^{jk(2\pi/T)t}dt
%		\xrightarrow{n=0}\\
%		&=&\frac{1}{T}\int_{-T/2}^{T/2}\delta(t)e^{jk(2\pi/T)t}dt=\frac{1}{T}
%		\hspace{8em}\text{\hl{$a_k=\frac{1}{T}$}}
%	\end{eqnarray*}
%	تابع متناوب است و سری فوریه دارد، پس تبدیل فوریه آن همان سری فوریه آن به صورت
%	جمع ضربه هاست.
%	\begin{eqnarray*}
%		P(j\omega)&=&\mathcal{F}\left\{\sum_{k=-\infty}^{\infty}a_ke^{jk(2\pi/T)t}\right\}=\sum_{k=-\infty}^{\infty}2\pi a_k\delta(\omega-k\frac{2\pi}{T})
%		=\frac{2\pi}{T}\sum_{k=-\infty}^{\infty}\delta(\omega-k\frac{2\pi}{T})
%	\end{eqnarray*}
%\end{qsolve}
%
%با توجه به اینکه با استفاده از این سیگنال نمونه برداری قطار ضربه از یک سیگنال پیوسته زمان انجام میدهیم و با استفاده نتیجه بدست آمده در قسمت
%قبل تبدیل فوریه سیگنال بدست آمده حاصل از ضرب این سیگنال در سیگنال دلخواه $x(t)$ را بدست آورید.
%
%\begin{qsolve}[]
%	\begin{eqnarray*}
%		x_p(t)&=&x(t)\times p(t)\Rightarrow X_p(j\omega)=\frac{1}{2\pi}X(j\omega)*P(j\omega)
%		=\frac{1}{2\pi}\convolve[\omega]{P}{X}\\
%		X_p(j\omega)&=&\frac{1}{2\pi}\sum_{k=-\infty}^{\infty}\intinf \frac{2\pi}{T}\delta(\tau-k\frac{2\pi}{T})X(j(\omega-\tau))d\tau
%		=\frac{1}{T}\sum_{k=-\infty}^{\infty}X(j(\omega-k\frac{2\pi}{T}))
%	\end{eqnarray*}
%\end{qsolve}
%
%حال نتیجه بدست آمده از قسمت قبل را با تبدیل فوریه گسسته سیگنال نمونه برداری شده $x[n]=x(nT)$ مقایسه کنید. حال شرطی روی نرخ
%نمونه برداری $F_s=\frac{1}{T_s}$ بدست آورید که تمام محتوای فرکانسی سیگنال اولیه پس از نمونه برداری حفظ شود. (شرط نایکوییست)
%
%\begin{qsolve}[]
%	پاسخ بدست آمده متناوب است، پس میتوان آن را به صورت یک سری فوریه نوشت.
%	یعنی داریم که : $X(j\omega)=\sum_{n=-\infty}^{\infty}C_ke^{jk\omega_0\omega}$
%	\splitqsolve
%	\begin{eqnarray*}
%		X_p(j\omega)&=&\frac{1}{T}\sum_{k=-\infty}^{\infty}X(j(\omega-k\frac{2\pi}{T}))
%		\xrightarrow{\text{\lr{periodic in $\frac{2\pi}{T}$}}}\sum_{n=-\infty}^{\infty}C_ne^{jnT\omega}\\
%		C_n&=&\frac{1}{2\pi/T}\int_{-\pi/T}^{\pi/T}X_p(j\omega)e^{jnT\omega}d\omega
%		=\frac{T}{2\pi}\int_{-\pi/T}^{\pi/T}\frac{1}{T}\sum_{k=-\infty}^{\infty}X(j(\omega-k\frac{2\pi}{T}))e^{jnT\omega}d\omega\\
%		&=&\xrightarrow{k=0}\frac{1}{2\pi}\int_{-\pi/T}^{\pi/T}X(j\omega)e^{jnT\omega}d\omega
%	\end{eqnarray*}
%	حال اگر داشتیم که $X(j\omega)\{|\omega|\leq\frac{\pi}{T}\}=0$
%	\begin{eqnarray*}
%		C_n&=&\frac{1}{2\pi}\int_{-\pi/T}^{\pi/T}X(j\omega)e^{jnT\omega}d\omega=
%		\frac{1}{2\pi}\int_{-\infty}^{\infty}X(j\omega)e^{jnT\omega}d\omega=x(nT)\\
%		X_p(j\omega)&=&\sum_{n=-\infty}^{\infty}C_ne^{jnT\omega}=\sum_{n=-\infty}^{\infty}x(nT)e^{jnT\omega}
%		=\sum_{n=-\infty}^{\infty}x[n]e^{jnT\omega}=X(e^{j\Omega})\when_{\Omega=\omega T}
%	\end{eqnarray*}
%	که این به ما شرط نایکوییست را میدهد. به صورتی که:
%	\[
%		\text{ : اگر داشته باشیم}
%        \forall \omega \geq \omega_s = \frac{\pi}{T}: X(j\omega)=0\Longrightarrow X_p(j\omega)=X(e^{j\Omega})\when_{\Omega=\omega T}
%	\]
%\end{qsolve}
%
%فرض کنید به علت محدودیت هایی که داریم شرط نایکوییست برقرار نباشد در این حالت روشی پیشنهاد دهید که محتوای فرکانسی کمتری از سیگنال
%در اثر نمونه برداری از بین برود.
%
%\begin{qsolve}[]
%    ناچار ایم که مقداری اطلاعات از دست بدهیم، زیرا در حالت خالص نمونه برداری، شرط نایکوییست برقرار نیست 
%    و دچار اعوجاج فرکانسی هستیم.
%
%    میتوانیم قبل از نمونه برداری اطلاعات فرکانسی را کم کنیم، اینگونه اطلاعات از بین رفته و 
%    فرکانسی اطلاعات کاهش میابد، ولی حداقل اعوجاج فرکانسی نداریم و نویز با فرکانس پایین ایجاد نمیکنیم.
%
%    به این کار Anti-Aliasing میگوییم. به این صورت که قبل از نمونه برداری، یک \lr{low-pass filter} استفاده میکنیم.
%
%    \begin{center}
%        \includegraphics*[width=0.8\linewidth]{pics/anti-aliasing.png}
%        \captionof{figure}{\lr{anti aliasing diagram}}
%    \end{center}
%\end{qsolve}